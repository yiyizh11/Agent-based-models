<pre><font color="#007f69">extensions</font><font color="#000000"> [ nw]<br /></font><font color="#007f69">globals</font><font color="#000000"> []<br /></font><font color="#007f69">turtles-own</font><font color="#000000"> [adopt? adopt-threshold ] </font><font color="#5a5a5a">;;add a property related to adoption</font><font color="#000000"><br /></font><font color="#660096">breed</font><font color="#000000"> [influentials influential]<br /></font><font color="#660096">breed</font><font color="#000000"> [regulars regular]<br /><br /></font><font color="#007f69">to</font><font color="#000000"> setup<br />  </font><font color="#0000aa">clear-all</font><font color="#000000"><br />  </font><font color="#0000aa">set-default-shape</font><font color="#000000"> regulars </font><font color="#963700">&quot;person&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> network-type </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;random&quot;</font><font color="#000000"> [ </font><font color="#5a5a5a">;; create turtles and links based on network chooser. 10% of all possible links will be created when &quot;random&quot; is chosen and density is set to 0.1 on the slider.</font><font color="#000000"><br />    nw:generate-random </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> number-of-agents density [<br />      </font><font color="#0000aa">set</font><font color="#000000"> adopt? </font><font color="#963700">false</font><font color="#5a5a5a">;; initializing adoption property</font><font color="#000000"><br />      </font><font color="#0000aa">setxy</font><font color="#000000"> </font><font color="#660096">random-xcor</font><font color="#000000"> </font><font color="#660096">random-ycor</font><font color="#000000"> </font><font color="#5a5a5a">;; seperate turtles spatially</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> adopt-threshold </font><font color="#660096">random-float</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#5a5a5a">;; assigning thresholds 0-100</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">white</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;person&quot;</font><font color="#000000"><br />    ]<br />  ]<br /><br />  </font><font color="#0000aa">if</font><font color="#000000"> network-type </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;preferential 2&quot;</font><font color="#000000"> [ </font><font color="#5a5a5a">;; create turtles and links based on network chooser. 2 links will be created for each turtle when preferential 2 is chosen. ingnores density slider.</font><font color="#000000"><br />    nw:generate-preferential-attachment </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> number-of-agents </font><font color="#963700">2</font><font color="#000000"> [<br />      </font><font color="#0000aa">set</font><font color="#000000"> adopt? </font><font color="#963700">false</font><font color="#5a5a5a">;; initializing adoption property</font><font color="#000000"><br />      </font><font color="#0000aa">setxy</font><font color="#000000"> </font><font color="#660096">random-xcor</font><font color="#000000"> </font><font color="#660096">random-ycor</font><font color="#000000"> </font><font color="#5a5a5a">;; seperate turtles spatially</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> adopt-threshold </font><font color="#660096">random-float</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#5a5a5a">;; assigning thresholds 0-100</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">white</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;person&quot;</font><font color="#000000"><br />    ]<br />  ]<br />  </font><font color="#0000aa">repeat</font><font color="#000000"> </font><font color="#963700">30</font><font color="#000000"> [</font><font color="#0000aa">layout-spring</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#963700">0.2</font><font color="#000000"> </font><font color="#963700">5</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">] </font><font color="#5a5a5a">;;reorganizing the network layout</font><font color="#000000"><br />   </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">n-of</font><font color="#000000"> (frac-influentials </font><font color="#660096">*</font><font color="#000000"> number-of-agents) </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">] [</font><font color="#5a5a5a">;; reclassify turtles as influentials when turtles have more than 2 friends and only apply to a fraction of total turtles</font><font color="#000000"><br />     </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">breed</font><font color="#000000"> influentials<br />     </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">green</font><font color="#000000"><br />     </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;star&quot;</font><font color="#000000"><br />  ]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">!=</font><font color="#000000"> influentials] [<br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">breed</font><font color="#000000"> regulars<br />  ]<br /><br />  </font><font color="#0000aa">reset-ticks</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> go<br /><br />  </font><font color="#0000aa">if</font><font color="#000000">  (</font><font color="#660096">not</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">color</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">white</font><font color="#000000">]) [<br />  </font><font color="#0000aa">stop</font><font color="#000000"> </font><font color="#5a5a5a">;; stop the procedure when there's no agent left not adopted</font><font color="#000000"><br />]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">not</font><font color="#000000"> adopt?][<br />    adopt </font><font color="#5a5a5a">;;ask the turtles to adopt or not adopt randomly</font><font color="#000000"><br />  ]<br /><br />  </font><font color="#0000aa">tick</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> reset-diffusion </font><font color="#5a5a5a">;; procedure holding the network constant</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> [<br />    </font><font color="#0000aa">set</font><font color="#000000"> adopt? </font><font color="#963700">false</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">white</font><font color="#000000"><br />  ]<br />  </font><font color="#0000aa">clear-all-plots</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /><br /></font><font color="#007f69">to</font><font color="#000000"> adopt </font><font color="#5a5a5a">;; procedure determining whether or not to adopt</font><font color="#000000"><br />  </font><font color="#5a5a5a">;;adopt based on a formula</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> media-influence </font><font color="#660096">+</font><font color="#000000"> social-influence </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [adopt?] </font><font color="#660096">/</font><font color="#000000"> number-of-agents </font><font color="#660096">&gt;</font><font color="#000000"> adopt-threshold [<br />      </font><font color="#0000aa">set</font><font color="#000000"> adopt? </font><font color="#963700">true</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000">]<br /><br />  </font><font color="#5a5a5a">;;adopt based on media influence</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">random-float</font><font color="#000000"> </font><font color="#963700">1.0</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> media-influence [<br />    </font><font color="#0000aa">set</font><font color="#000000"> adopt? </font><font color="#963700">true</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">blue</font><font color="#000000">]<br /><br />  </font><font color="#5a5a5a">;;adopt based on social influence if we are influentials</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> (</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> influentials) [<br />    </font><font color="#0000aa">let</font><font color="#000000"> neighbors-adopted </font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [adopt? </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> influentials]<br />    </font><font color="#0000aa">let</font><font color="#000000"> total-neighbors </font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> influentials]<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> neighbors-adopted </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [ </font><font color="#5a5a5a">;; adding if condition to get rid of the error of something being divided by 0, i.e. count toatl-neighbors equals 0</font><font color="#000000"><br />      </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">random-float</font><font color="#000000"> </font><font color="#963700">1.0</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> (social-influence </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#660096">count</font><font color="#000000"> neighbors-adopted </font><font color="#660096">/</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> total-neighbors)) [<br />    </font><font color="#0000aa">set</font><font color="#000000"> adopt? </font><font color="#963700">true</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">pink</font><font color="#000000">]<br />    ]<br />  ]<br />    </font><font color="#5a5a5a">;;adopt based on social influence if we are regulars</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> (</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> regulars)[<br />    </font><font color="#0000aa">let</font><font color="#000000"> inf-neighbors-adopted </font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [adopt? </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> influentials]<br />    </font><font color="#0000aa">let</font><font color="#000000"> inf-neighbors-total </font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> influentials]<br />    </font><font color="#0000aa">let</font><font color="#000000"> reg-neighbors-adopted </font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [adopt? </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> regulars]<br />    </font><font color="#0000aa">let</font><font color="#000000"> reg-neighbors-total </font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> regulars]<br />    </font><font color="#0000aa">let</font><font color="#000000"> influential-influence </font><font color="#660096">count</font><font color="#000000"> inf-neighbors-adopted </font><font color="#660096">/</font><font color="#000000"> (</font><font color="#660096">count</font><font color="#000000"> inf-neighbors-total </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">0.01</font><font color="#000000">) </font><font color="#5a5a5a">;; +0.01 or a very small number to get rid of the error of something being divided by 0, i.e. count toatl-neighbors equals 0</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> regular-influence </font><font color="#963700">0</font><font color="#000000"><br />    </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> reg-neighbors-total </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [<br />      </font><font color="#0000aa">set</font><font color="#000000"> regular-influence </font><font color="#660096">count</font><font color="#000000"> reg-neighbors-adopted </font><font color="#660096">/</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> reg-neighbors-total]<br />    </font><font color="#0000aa">let</font><font color="#000000"> regular-weight (</font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> influential-weight)<br />    </font><font color="#0000aa">let</font><font color="#000000"> neighbor-influence (influential-influence </font><font color="#660096">*</font><font color="#000000"> influential-weight) </font><font color="#660096">+</font><font color="#000000"> (regular-influence </font><font color="#660096">*</font><font color="#000000"> regular-weight)<br />    </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">random-float</font><font color="#000000"> </font><font color="#963700">1.0</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> (social-influence </font><font color="#660096">*</font><font color="#000000"> neighbor-influence) [<br />    </font><font color="#0000aa">set</font><font color="#000000"> adopt? </font><font color="#963700">true</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">cyan</font><font color="#000000">]<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /></font>
</pre>
