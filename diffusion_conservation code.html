<pre><font color="#007f69">patches-own</font><font color="#000000"> [ water-availability conserved? ]<br /></font><font color="#007f69">turtles-own</font><font color="#000000"> [ adopt? ]<br /></font><font color="#007f69">undirected-link-breed</font><font color="#000000"> [geo-links geo-link]</font><font color="#5a5a5a">;; links linking geographic neighbors</font><font color="#000000"><br /></font><font color="#007f69">undirected-link-breed</font><font color="#000000"> [social-links social-link]</font><font color="#5a5a5a">;; links linking social neighbors</font><font color="#000000"><br /></font><font color="#660096">breed</font><font color="#000000"> [urbans urban]<br /></font><font color="#660096">breed</font><font color="#000000"> [rurals rural]<br /></font><font color="#007f69">extensions</font><font color="#000000"> [nw]<br /><br /></font><font color="#007f69">to</font><font color="#000000"> setup<br />  </font><font color="#0000aa">clear-all</font><font color="#000000"><br />  </font><font color="#0000aa">set-default-shape</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#963700">&quot;person&quot;</font><font color="#000000"><br />  </font><font color="#5a5a5a">;;set up social and geographic networks</font><font color="#000000"><br />  nw:generate-random </font><font color="#660096">turtles</font><font color="#000000"> social-links number-of-agents network-density [<br />    </font><font color="#0000aa">set</font><font color="#000000"> adopt? </font><font color="#963700">false</font><font color="#5a5a5a">;; initializing adoption property</font><font color="#000000"><br />    </font><font color="#0000aa">setxy</font><font color="#000000"> </font><font color="#660096">random-xcor</font><font color="#000000"> </font><font color="#660096">random-ycor</font><font color="#000000"> </font><font color="#5a5a5a">;; seperate turtles spatially</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000"><br />  ]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> [create-geo-links-with </font><font color="#660096">turtles-on</font><font color="#000000"> </font><font color="#660096">neighbors</font><font color="#000000"><br />  ]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> geo-links] [<br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000"><br />  ]<br />  </font><font color="#5a5a5a">;;create rural and urban residents</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">n-of</font><font color="#000000"> (frac-rurals </font><font color="#660096">*</font><font color="#000000"> number-of-agents) </font><font color="#660096">turtles</font><font color="#000000"> [<br />     </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">breed</font><font color="#000000"> rurals<br />     </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">blue</font><font color="#000000"><br />  ]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">!=</font><font color="#000000"> rurals][<br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">breed</font><font color="#000000"> urbans<br />  ]<br />  </font><font color="#5a5a5a">;;initailize patches</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> [<br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">white</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> water-availability max-water<br />    </font><font color="#0000aa">set</font><font color="#000000"> conserved? </font><font color="#963700">false</font><font color="#000000"><br />  ]<br /><br />  </font><font color="#0000aa">reset-ticks</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> go<br />  </font><font color="#0000aa">if</font><font color="#000000">  (</font><font color="#660096">not</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [adopt? </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">false</font><font color="#000000">]) [<br />  </font><font color="#0000aa">stop</font><font color="#000000"> </font><font color="#5a5a5a">;; stop the procedure when there's no agent left not adopted</font><font color="#000000"><br />]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> rurals [<br />    rural-conserve<br />  ]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> urbans [<br />    urban-conserve<br />  ]<br />  update-environment<br />  </font><font color="#0000aa">tick</font><font color="#000000"><br /><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> rural-conserve<br />  </font><font color="#0000aa">if</font><font color="#000000"> (adopt? </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">false</font><font color="#000000">) [<br />    </font><font color="#5a5a5a">;;rural residents are assumed 5 times less likely to be influenced by regulation (slow response)</font><font color="#000000"><br />    </font><font color="#0000aa">if</font><font color="#000000"> (</font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">5</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">and</font><font color="#000000"> (</font><font color="#660096">random-float</font><font color="#000000"> </font><font color="#963700">1.0</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> regulation-influence)[<br />      </font><font color="#0000aa">set</font><font color="#000000"> adopt? </font><font color="#963700">true</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> conserved? </font><font color="#963700">true</font><font color="#000000"><br />    ]<br />    </font><font color="#5a5a5a">;;rural residents are influenced by rural adopters in the neighborhood and social links with urban adopters</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> rural-neighbors-adopted geo-link-neighbors </font><font color="#660096">with</font><font color="#000000"> [adopt? </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> rurals]<br />    </font><font color="#0000aa">let</font><font color="#000000"> urban-neighbors-adopted social-link-neighbors </font><font color="#660096">with</font><font color="#000000"> [adopt? </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> urbans]<br />    </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">random-float</font><font color="#000000"> </font><font color="#963700">1.0</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> (</font><font color="#660096">count</font><font color="#000000"> rural-neighbors-adopted </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> urban-neighbors-adopted) </font><font color="#660096">/</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">link-neighbors</font><font color="#000000"> [<br />      </font><font color="#0000aa">set</font><font color="#000000"> adopt? </font><font color="#963700">true</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> conserved? </font><font color="#963700">true</font><font color="#000000"><br />    ]<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> urban-conserve<br />  </font><font color="#0000aa">if</font><font color="#000000"> (adopt? </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">false</font><font color="#000000">)[<br />    </font><font color="#5a5a5a">;;urban residents respond more quickly to regulation</font><font color="#000000"><br />    </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">random-float</font><font color="#000000"> </font><font color="#963700">1.0</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> regulation-influence[<br />      </font><font color="#0000aa">set</font><font color="#000000"> adopt? </font><font color="#963700">true</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> conserved? </font><font color="#963700">true</font><font color="#000000"><br />    ]<br />    </font><font color="#5a5a5a">;;urban residents are influenced by urban adopters in the neighborhood</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> neighbors-adopted geo-link-neighbors </font><font color="#660096">with</font><font color="#000000"> [adopt? </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> urbans ]<br />    </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">random-float</font><font color="#000000"> </font><font color="#963700">1.0</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> neighbors-adopted </font><font color="#660096">/</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">link-neighbors</font><font color="#000000"> [<br />      </font><font color="#0000aa">set</font><font color="#000000"> adopt? </font><font color="#963700">true</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> conserved? </font><font color="#963700">true</font><font color="#000000"><br />    ]<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> update-environment<br />  </font><font color="#0000aa">let</font><font color="#000000"> min-water-availability </font><font color="#660096">min</font><font color="#000000"> [water-availability] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> max-water-availability </font><font color="#660096">max</font><font color="#000000"> [water-availability] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [conserved? </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">false</font><font color="#000000">] [<br />    </font><font color="#0000aa">set</font><font color="#000000"> water-availability water-availability </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#660096">scale-color</font><font color="#000000"> </font><font color="#963700">green</font><font color="#000000"> water-availability min-water-availability max-water-availability]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [conserved? </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">true</font><font color="#000000">] [<br />    </font><font color="#0000aa">set</font><font color="#000000"> water-availability water-availability </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#660096">scale-color</font><font color="#000000"> </font><font color="#963700">green</font><font color="#000000"> water-availability min-water-availability max-water-availability]<br /></font><font color="#007f69">end</font>
</pre>
